
<html>
    <head> 
        <meta charset='utf-8' />
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel= "stylesheet" href="/static/css/style.css" type="text/css">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <!-- KaTex -->
        <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"
      crossorigin="anonymous">

        <title> Metropolis Hastings </title>
    </head>

    <body>
        <div class="container">
            <header>
                <h1> <a href='/'> tangarts </a> </h1>
                <div id="header_wrap" class="wrapper">
                    <nav id="navbar" >
                        <ul class="list-none" >
                            <li><a href="/about">about</a> &centerdot;</li>
                            <li><a href="/archives.html">archive</a> &centerdot;</li>
                            <li><a href="/now">now</a> &centerdot;</li>
                            <li><a href="mailto:nehemiahcampbell@hotmail.co.uk">contact</a></li>
                        </ul> 

                    </nav>
                </div>

            </header>  
            <main class="wrapper">

                <hr> 


<h1> Metropolis Hastings </h1>
<div class=date>
        2021-04-27
        | Modified: 2021-04-27

</div>

<article><p>We continue the series of Monte Carlo methods by covering Markov chain based sampling algorithms.</p>
<p>Metropolis Hastings is a sampling algorithm that relies on the guarantees from invariant distributions.</p>
<p><strong>Metropolis Hastings</strong></p>
<hr>
<p>Initialise <span class="math">\(X^{(0)}\)</span> and for <span class="math">\(t \geq 1\)</span></p>
<ol>
<li>Draw <span class="math">\(X \sim Q(\cdot \mid X^{(t-1)})\)</span></li>
<li>Compute <div class="math">$$\alpha(X \mid X^{(t-1)}) = \min \left(1, \frac{\pi(X)Q(X^{(t-1)} \mid X)}{\pi(X^{(t-1)})Q(X \mid X^{(t-1)})} \right)$$</div>
</li>
</ol>
<p>Set <span class="math">\(X^{(t)} = X\)</span> with probability <span class="math">\(\alpha(X \mid X^{(t-1)})\)</span> else <span class="math">\(X^{(t)} = X^{(t-1)}\)</span>.</p>
<hr>
<p>The conditional probability of accepting any proposed state given the chain is in <span class="math">\(i\)</span> is
</p>
<div class="math">$$ a(i) = \sum_{j \in \mathbb S} \alpha(j \mid i)Q_{i, j} $$</div>
<p>From the algorithm we see the transition kernel <span class="math">\(K_{i,j} = \alpha(j\mid i)Q_{i,i} + (1 - a(i))\delta_{ij}\)</span> generates a 
Markov chain for the sequence <span class="math">\((X^{(t)})_{t \geq 0}\)</span> using the distribution <span class="math">\(\pi\)</span>.</p>
<p>An advantage of using MH algorithm is we only need to know a distribution that is proportional to <span class="math">\(\pi\)</span>.</p>
<p>There are two popular Metropolis-Hastings variations, the Metropolis algorithm
that uses a symmetric proposal distribution <span class="math">\(Q(X^{(t)} \mid X^{(t-1)}) = Q(X^{(t-1)} \mid X^{(t)})\)</span>. Common 
distributions used are normal, <span class="math">\(\mathcal N(\mu, \sigma^2)\)</span> and uniform, <span class="math">\(U[a, b]\)</span>.
The resulting acceptance ratio is simplified to</p>
<div class="math">$$\alpha(X \mid X^{(t-1)}) = \min \left(1, \frac{\pi(X)}{\pi(X^{(t-1)})} \right)$$</div>
<p><strong>Gibbs Sampling</strong></p>
<p>Gibbs sampling uses full conditional distributions as the proposal distribution. For <span class="math">\(j = 1,2, \ldots, n\)</span> 
the proposal </p>
<div class="math">$$Q(X \mid X^{(t-1)}) = \pi(X_j \mid X_1^{(t-1)}, \ldots, X_1^{(t-1)}, X_1^{(t+1)}, \ldots, X_1^{(n)})$$</div>
<p>
The acceptance probability <span class="math">\(\alpha(X \mid X^{(t-1)})\)</span> can be shown to be equal to 1.</p>
<hr>
<p>Initialise <span class="math">\(X^{(0)} = (X_1^{(0)}, X_2^{(0)})\)</span> and for <span class="math">\(t \geq 1\)</span></p>
<ol>
<li>Draw <span class="math">\(X_1^{(t)} \sim \pi_{1|2}(\cdot \mid X_2^{(t-1)})\)</span></li>
<li>Draw <span class="math">\(X_2^{(t)} \sim \pi_{2|1}(\cdot \mid X_1^{(t)})\)</span></li>
</ol>
<hr>
<p>The transition kernel that guarantees an invariant distribution is</p>
<div class="math">$$K(\mathbf x, \mathbf y) = \pi_{1|2}(y_1 \mid x_2)\pi_{2|1}(y_2 \mid y_1)$$</div>
<p>
with <span class="math">\(\mathbf x = (x_1, x_2) = (X_1^{(t-1)}, X_2^{(t-1)})\)</span>
and <span class="math">\(\mathbf y = (y_1, y_2) = (X_1^{(t)}, X_2^{(t)})\)</span></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></article>



            </main> 

            <footer>
                <p>&centerdot; &centerdot; &centerdot;</p> 
            </footer>

        </div>
    </body>
</html>
